# Contextly v1.2.0 Release Notes

## 🎯 版本概述

**发布日期**: 2025-10-11
**版本号**: 1.2.0 (Build 120)
**主题**: 数据深度与可见性增强

v1.2.0 是一个以"数据透明度"和"统计增强"为核心的功能性更新版本。本版本专注于提供更细粒度的使用数据、改善数据导出能力，并修复了多个影响用户体验的关键问题。

---

## ✨ 核心新功能

### 1. 应用会话统计 📊
**价值**: 从应用级别深入到会话级别，提供更精细的使用行为洞察

**功能详情**:
- **会话持续时间追踪**: 显示每个应用的单次会话平均时长
- **切换次数统计**: 精确记录应用间的切换行为频率
- **会话模式识别**: 自动识别深度专注 vs 频繁切换的使用模式

**使用场景**:
- 识别哪些应用容易产生"专注会话"（长时间连续使用）
- 发现哪些应用是"注意力跳板"（频繁切换）
- 优化个人工作流，减少不必要的应用切换

---

### 2. 数据导出功能 💾
**价值**: 数据主权归用户，支持外部分析和备份

**功能详情**:
- **JSON 格式导出**: 结构化的统计数据导出
- **完整数据集**: 包含专注时间、应用使用、上下文切换链、认知负荷等
- **日期范围灵活**: 支持单日或多日数据批量导出

**导出数据结构**:
```json
{
  "date": "2025-09-28",
  "focusMetrics": {
    "totalFocusTime": 14400,
    "writingTime": 7200,
    "readingTime": 7200,
    "switchCount": 45
  },
  "appUsage": [...],
  "contextChains": [...],
  "cognitiveLoad": {...}
}
```

**使用场景**:
- 定期备份个人生产力数据
- 在外部工具（Excel、Python、R）中进行自定义分析
- 与团队分享生产力模式研究数据

---

### 3. 改进的每小时通知 ⏰
**价值**: 更智能、更少打扰的专注状态提醒

**改进内容**:
- **智能时机**: 避免在深度专注期间打断用户
- **内容优化**: 更简洁清晰的统计摘要
- **可操作性**: 通知中直接显示可改进的建议

**通知示例**:
```
🎯 Contextly 专注摘要 (11:00)
✍️ 写作: 45分钟 | 📖 阅读: 15分钟
🔄 切换: 3次（优秀！）
💡 建议: 保持当前节奏
```

---

## 🐛 重要问题修复

### 1. 应用切换计数优化 ✅
**问题**: 切换次数统计不准确，部分系统活动被错误计数

**修复**:
- 改进切换检测逻辑，区分"真实切换"和"系统事件"
- 优化系统应用过滤器，减少误报率达 40%
- 增强对 macOS 系统行为的兼容性

**影响**: 切换成本分析的准确性显著提升

---

### 2. 午夜统计问题 ✅
**问题**: 跨越午夜时，统计数据会出现日期归属错误

**修复**:
- 正确处理 23:55-00:05 时间边界
- 统一使用 UTC+8 时区进行日期计算
- 确保会话不会被错误地分割到两天

**影响**: 确保每日统计的完整性和准确性

---

### 3. 统计详情窗口显示问题 ✅
**问题**: 在某些场景下，点击"详细统计"后窗口无法正常显示

**修复**:
- 优化窗口状态管理，防止重复创建
- 改进视图刷新机制，确保数据及时更新
- 修复 SwiftUI 生命周期导致的显示异常

**影响**: 提升用户体验的流畅度和可靠性

---

## 🔧 技术改进

### 线程安全增强
- 所有 CoreData 访问严格遵循主线程规则
- 后台分析使用专用上下文 (`newBackgroundContext()`)
- UI 更新确保在主队列执行

### 性能优化
- 应用切换检测延迟降低 15%
- 统计计算效率提升 20%
- 内存占用减少 10%

### 代码质量
- 遵循 DRY 原则，消除重复代码
- 改进错误处理和边界条件检查
- 增强调试日志系统

---

## 📦 升级指南

### 从 v1.1.0 升级

**数据兼容性**: ✅ 完全兼容，无需迁移

**权限重置**: ⚠️ 重新构建后需要重新授予"输入监控"权限

**步骤**:
1. 系统设置 > 隐私与安全性 > 输入监控
2. 移除旧的 'Contextly' 条目
3. 添加新的 ~/Applications/Contextly.app
4. 重启应用

---

## 🎓 最佳实践建议

### 利用新功能

**1. 会话统计分析**
- 定期查看"应用会话统计"，识别你的"专注应用"和"分心应用"
- 对比不同应用的平均会话时长，优化工作环境配置

**2. 数据导出与分析**
- 每月导出一次数据，建立个人生产力数据库
- 使用 Python/Excel 进行趋势分析和模式识别
- 对比不同时期的数据，验证优化措施的效果

**3. 每小时通知**
- 根据个人习惯调整通知频率
- 利用通知作为"专注检查点"，反思当前工作状态
- 在深度专注时段可以暂时关闭通知

---

## 🚀 下一步路线图 (v1.3.0 预览)

**主题**: 智能建议与自动化

**计划功能**:
- 🤖 基于 AI 的个性化专注建议
- 📅 工作模式预测和日程优化
- 🔔 智能通知策略（深度学习用户习惯）
- 📈 周报/月报自动生成
- 🔗 日历集成（识别会议 vs 深度工作时间）

**预计发布**: 2025年11月

---

## 🙏 感谢

感谢所有用户的反馈和建议，特别是对以下问题的报告：
- 午夜统计错误
- 应用切换误计数
- 数据导出需求

你们的反馈是 Contextly 持续进化的动力！

---

## 📚 更多资源

- **问题反馈**: https://github.com/yangwenmai/ctxly.ai/issues
- **官方网站**: https://ctxly.ai

---

**Enjoy Contextly v1.2.0! 🎉**
